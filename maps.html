<!DOCTYPE html>
<html>
<head>
    <title>Philly Navigation System</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
  <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #map {
            height: 400px;
            width: 80%;
            margin-top: 20px;
        }
        #directionsPanel, #trainStatus {
            width: 80%;
            margin: 20px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .container {
            width: 80%;
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        .feature {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            width: 48%;
        }
        .clock {
            text-align: center;
            font-size: 24px;
            margin-top: 20px;
        }
        header {
            width: 100%;
            box-sizing: border-box;
            background-color: #333;
            color: #fff;
            padding: 20px 0;
            text-align: center;
        }
        nav {
            width: 100%;
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 10px;
            overflow-x: auto;
        }
        nav a {
            flex-grow: 1;
            text-align: center;
            min-width: 120px;
            color: #fff;
            text-decoration: none;
            padding: 10px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        nav a:hover {
            background-color: #555;
        }
        #profile-section {
            position: relative;
        }
        #profile-username {
            display: inline-block;
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        #profile-username:hover {
            background-color: #f2f2f2;
        }
        .dropdown {
            position: absolute;
            top: calc(100% + 5px);
            left: 0;
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            display: none;
            min-width: 120px;
        }
        #profile-section:hover .dropdown {
            display: block;
        }
        .dropdown a {
            display: block;
            padding: 8px 12px;
            text-decoration: none;
            color: #333;
            transition: background-color 0.3s;
        }
        .dropdown a:hover {
            background-color: #f2f2f2;
        }
    </style>
  
</head>
<body>

  
  <header>
        <h1>Philadelphia Sports Navigation System</h1>
        <nav>
            <a href="index.html">Home</a>
            <a href="about.html">About</a>
            <a href="#contact">Contact</a>
            <div id="profile-section">
                <span id="profile-username" onclick="toggleDropdown()">Username</span>
                <div class="dropdown" id="profile-dropdown">
                    <a href="#" onclick="logout()">Log Out</a>
                    <a href="settings.html">Settings</a>
                </div>
            </div>
        </nav>
    </header>
  <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3060.7884055003256!2d-75.1700964232959!3d39.90136947152711!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89c6c7a9e03add31%3A0xf4050036d4293709!2sLincoln%20Financial%20Field!5e0!3m2!1sen!2sus!4v1712321453863!5m2!1sen!2sus" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
  <div id="map"></div>
  <div id="directionsPanel">Directions will appear here.</div>
  <div id="trainStatus">Train statuses will be shown here.</div>
  <div class="container">
      <div class="feature">
          Select a stadium:
          <select id="stadiumSelect" onchange="lookupAddress()">
              <option value="One Lincoln Financial Field Way, Philadelphia, PA 19148">Eagles - Lincoln Financial Field</option>
              <option value="1 Citizens Bank Way, Philadelphia, PA 19148">Phillies - Citizens Bank Park</option>
              <option value="3601 S Broad St, Philadelphia, PA 19148">76ers and Flyers - Wells Fargo Center</option>
          </select>
      </div>
      <div class="feature">
          Enter your address if location is unavailable:
          <input type="text" id="addressInput" placeholder="1234 Main St, Philadelphia, PA">
          <button onclick="lookupAddress(document.getElementById('addressInput').value)">Go</button>
      </div>
      <div class="feature clock" id="clock">00:00:00</div>
  </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
         integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
         crossorigin=""></script>
    <script>
        function updateClock() {
            const now = new Date();
            document.getElementById('clock').innerHTML = now.toLocaleTimeString();
        }
        setInterval(updateClock, 1000);
        updateClock(); // Initialize clock immediately

        // Initialize Leaflet map
        var map;
        function initMap() {
            map = L.map('map').setView([39.9526, -75.1652], 13);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            // Try to use the device's location
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    var userLocation = [position.coords.latitude, position.coords.longitude];
                    setMap(userLocation);
                }, function() {
                    // If location access is denied or unavailable, use a default
                    setMap([39.9526, -75.1652]); // Default to Philadelphia's coordinates
                });
            } else {
                // If Geolocation is not supported by the browser, use a default
                setMap([39.9526, -75.1652]); // Default to Philadelphia's coordinates
            }
        }

        function setMap(coords) {
            map.setView(coords, 13);
            var marker = L.marker(coords).addTo(map);
            marker.bindPopup("Your location").openPopup();
        }

        // Functionality for address input
        function addressEntered() {
            var address = document.getElementById('addressInput').value;
            getCoordinatesForAddress(address);
        }

        function getCoordinatesForAddress(address) {
            var url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(address)}`;

            fetch(url, {
                method: 'GET',
                headers: {
                    'User-Agent': 'YourAppName/1.0 (YourContactEmailAddress)',
                    'Accept': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                if(data.length > 0) {
                    var coords = [parseFloat(data[0].lat), parseFloat(data[0].lon)];
                    setMap(coords);
                } else {
                    alert('Address not found.');
                }
            })
            .catch(error => console.error('Error fetching data:', error));
        }

        document.addEventListener('DOMContentLoaded', function() {
            initMap();
        });

        // Toggle and Logout functions unchanged
        var profileDropdown = document.getElementById('profile-dropdown');
        function toggleDropdown() {
            profileDropdown.style.display = (profileDropdown.style.display === 'block') ? 'none' : 'block';
        }

        function logout() {
            alert('Logged out successfully!');
            profileDropdown.style.display = 'none';
        }
    </script>
</body>
</html>
